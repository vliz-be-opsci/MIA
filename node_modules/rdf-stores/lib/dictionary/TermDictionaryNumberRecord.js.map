{"version":3,"file":"TermDictionaryNumberRecord.js","sourceRoot":"","sources":["TermDictionaryNumberRecord.ts"],"names":[],"mappings":";;;AACA,uDAA+C;AAC/C,2CAAwD;AAGxD;;GAEG;AACH,MAAa,0BAA0B;IAOrC,YAAmB,cAA+B,IAAI,8BAAW,EAAE;QAN3D,WAAM,GAAG,CAAC,CAAC;QACF,eAAU,GAA2B,EAAE,CAAC;QACxC,sBAAiB,GAA2B,EAAE,CAAC;QAEhD,aAAQ,GAAG,EAAE,aAAa,EAAE,KAAK,EAAE,CAAC;QAGlD,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC;IACjC,CAAC;IAEM,MAAM,CAAC,IAAc;QAC1B,MAAM,GAAG,GAAG,IAAA,yBAAY,EAAC,IAAI,CAAC,CAAC;QAC/B,IAAI,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;QACnC,IAAI,OAAO,KAAK,SAAS,EAAE;YACzB,OAAO,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;YACxB,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,GAAG,OAAO,CAAC;YAC/B,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,GAAG,GAAG,CAAC;SACvC;QACD,OAAO,OAAO,CAAC;IACjB,CAAC;IAEM,cAAc,CAAC,IAAc;QAClC,MAAM,GAAG,GAAG,IAAA,yBAAY,EAAC,IAAI,CAAC,CAAC;QAC/B,OAAO,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;IAC9B,CAAC;IAEM,MAAM,CAAC,QAAgB;QAC5B,MAAM,MAAM,GAAG,IAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,CAAC;QAChD,IAAI,MAAM,KAAK,SAAS,EAAE;YACxB,MAAM,IAAI,KAAK,CAAC,aAAa,QAAQ,oCAAoC,CAAC,CAAC;SAC5E;QACD,OAAO,IAAA,yBAAY,EAAC,MAAM,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;IAChD,CAAC;IAEM,CAAE,SAAS;QAChB,KAAK,MAAM,GAAG,IAAI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,EAAE;YACrD,MAAM,MAAM,CAAC,QAAQ,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC;SAChC;IACH,CAAC;IAEM,iBAAiB,CAAC,mBAA6B;QACpD,MAAM,IAAI,KAAK,CAAC,oCAAoC,CAAC,CAAC;IACxD,CAAC;IAEM,wBAAwB,CAAC,mBAA6B;QAC3D,MAAM,IAAI,KAAK,CAAC,2CAA2C,CAAC,CAAC;IAC/D,CAAC;CACF;AAhDD,gEAgDC","sourcesContent":["import type * as RDF from '@rdfjs/types';\nimport { DataFactory } from 'rdf-data-factory';\nimport { stringToTerm, termToString } from 'rdf-string';\nimport type { ITermDictionary } from './ITermDictionary';\n\n/**\n * A term dictionary that encodes to numbers, and stores the dictionary in memory in a Record.\n */\nexport class TermDictionaryNumberRecord implements ITermDictionary<number> {\n  private lastId = 0;\n  private readonly dictionary: Record<string, number> = {};\n  private readonly reverseDictionary: Record<number, string> = {};\n  private readonly dataFactory: RDF.DataFactory;\n  public readonly features = { quotedTriples: false };\n\n  public constructor(dataFactory: RDF.DataFactory = new DataFactory()) {\n    this.dataFactory = dataFactory;\n  }\n\n  public encode(term: RDF.Term): number {\n    const key = termToString(term);\n    let encoded = this.dictionary[key];\n    if (encoded === undefined) {\n      encoded = this.lastId++;\n      this.dictionary[key] = encoded;\n      this.reverseDictionary[encoded] = key;\n    }\n    return encoded;\n  }\n\n  public encodeOptional(term: RDF.Term): number | undefined {\n    const key = termToString(term);\n    return this.dictionary[key];\n  }\n\n  public decode(encoding: number): RDF.Term {\n    const string = this.reverseDictionary[encoding];\n    if (string === undefined) {\n      throw new Error(`The value ${encoding} is not present in this dictionary`);\n    }\n    return stringToTerm(string, this.dataFactory);\n  }\n\n  public * encodings(): IterableIterator<number> {\n    for (const key of Object.keys(this.reverseDictionary)) {\n      yield Number.parseInt(key, 10);\n    }\n  }\n\n  public findQuotedTriples(quotedTriplePattern: RDF.Quad): IterableIterator<RDF.Term> {\n    throw new Error('findQuotedTriples is not supported');\n  }\n\n  public findQuotedTriplesEncoded(quotedTriplePattern: RDF.Quad): IterableIterator<number> {\n    throw new Error('findQuotedTriplesEncoded is not supported');\n  }\n}\n"]}