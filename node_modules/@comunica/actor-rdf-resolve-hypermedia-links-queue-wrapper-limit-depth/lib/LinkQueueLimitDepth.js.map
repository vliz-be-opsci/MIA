{"version":3,"file":"LinkQueueLimitDepth.js","sourceRoot":"","sources":["LinkQueueLimitDepth.ts"],"names":[],"mappings":";;;AACA,6GAAoF;AAEpF;;GAEG;AACH,MAAa,mBAAoB,SAAQ,yDAAgB;IAGvD,YAAmB,SAAqB,EAAE,KAAa;QACrD,KAAK,CAAC,SAAS,CAAC,CAAC;QACjB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;IACrB,CAAC;IAEe,IAAI,CAAC,IAAW,EAAE,MAAa;QAC7C,wCAAwC;QACxC,IAAI,CAAC,MAAM,CAAC,QAAQ,EAAE,CAAC;YACrB,MAAM,CAAC,QAAQ,GAAG,EAAE,CAAC;QACvB,CAAC;QACD,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,0BAAkB,CAAC,EAAE,CAAC;YACzC,MAAM,CAAC,QAAQ,CAAC,0BAAkB,CAAC,GAAG,CAAC,CAAC;QAC1C,CAAC;QAED,uBAAuB;QACvB,MAAM,KAAK,GAAqB,MAAM,CAAC,QAAQ,CAAC,0BAAkB,CAAE,GAAG,CAAC,CAAC;QAEzE,qDAAqD;QACrD,IAAI,KAAK,GAAG,IAAI,CAAC,KAAK,EAAE,CAAC;YACvB,OAAO,KAAK,CAAC;QACf,CAAC;QAED,oCAAoC;QACpC,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC;YACnB,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;QACrB,CAAC;QACD,IAAI,CAAC,QAAQ,CAAC,0BAAkB,CAAC,GAAG,KAAK,CAAC;QAC1C,OAAO,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;IAClC,CAAC;CACF;AAhCD,kDAgCC;AAEY,QAAA,kBAAkB,GAAG,oEAAoE,CAAC","sourcesContent":["import type { ILinkQueue, ILink } from '@comunica/bus-rdf-resolve-hypermedia-links-queue';\nimport { LinkQueueWrapper } from '@comunica/bus-rdf-resolve-hypermedia-links-queue';\n\n/**\n * A link queue that only allows the given number of links to be pushed into it.\n */\nexport class LinkQueueLimitDepth extends LinkQueueWrapper {\n  private readonly limit: number;\n\n  public constructor(linkQueue: ILinkQueue, limit: number) {\n    super(linkQueue);\n    this.limit = limit;\n  }\n\n  public override push(link: ILink, parent: ILink): boolean {\n    // Ensure our parent has a defined depth\n    if (!parent.metadata) {\n      parent.metadata = {};\n    }\n    if (!parent.metadata[KEY_METADATA_DEPTH]) {\n      parent.metadata[KEY_METADATA_DEPTH] = 0;\n    }\n\n    // Determine link depth\n    const depth: number = (<number> parent.metadata[KEY_METADATA_DEPTH]) + 1;\n\n    // Don't allow pushing if we exceeded our depth limit\n    if (depth > this.limit) {\n      return false;\n    }\n\n    // Set the depth of our current link\n    if (!link.metadata) {\n      link.metadata = {};\n    }\n    link.metadata[KEY_METADATA_DEPTH] = depth;\n    return super.push(link, parent);\n  }\n}\n\nexport const KEY_METADATA_DEPTH = 'actor-rdf-resolve-hypermedia-links-queue-wrapper-limit-depth:depth';\n"]}